SYNOPSIS
This PowerShell script remediates DISA STIG ID WN10-SO-000245 by enabling User Account Control (UAC) Admin Approval Mode for the built-in Administrator account.

.NOTES
    Author          : Kevin Mejia
    LinkedIn        :https://www.linkedin.com/in/kevin-mejia-901039270/
    GitHub          : https://github.com/Kevin-M1
    Date Created    : 2025-09-03
    Last Modified   : 2025-09-03
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-SO-000245

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
Syntax:
    PS C:\> .\__(WN10-SO-000245).ps1 
   
PS C:\Windows\system32> # Run as Administrator
>>
>> function Set-Reg {
>>     param([string]$Path,[string]$Name,[ValidateSet('DWord','QWord','String','ExpandString','Binary','MultiString')]$Type,[Parameter(Mandatory)]$Value)
>>     if (-not (Test-Path $Path)) { New-Item -Path $Path -Force | Out-Null }
>>     New-ItemProperty -Path $Path -Name $Name -PropertyType $Type -Value $Value -Force | Out-Null
>> }
>>
>> $uac64 = 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
>> $uac32 = 'HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Policies\System'  # for some scanners
>>
>> # Required for WN10-SO-000245
>> Set-Reg -Path $uac64 -Name 'FilterAdministratorToken' -Type DWord -Value 1
>> Set-Reg -Path $uac32 -Name 'FilterAdministratorToken' -Type DWord -Value 1
>>
>> # Prerequisite: Run all admins in Admin Approval Mode
>> Set-Reg -Path $uac64 -Name 'EnableLUA' -Type DWord -Value 1
>>
>> # Common companion settings (help some plugins pass)
>> # Prompt for consent on the secure desktop
>> Set-Reg -Path $uac64 -Name 'ConsentPromptBehaviorAdmin' -Type DWord -Value 2
>> # Ensure prompts happen on the secure desktop
>> Set-Reg -Path $uac64 -Name 'PromptOnSecureDesktop' -Type DWord -Value 1
>>
>> # Apply and show
>> try { gpupdate /target:computer /force | Out-Null } catch {}
>>
>> Get-ItemProperty -Path $uac64, $uac32 |
>>   Select-Object PSPath, FilterAdministratorToken, EnableLUA, ConsentPromptBehaviorAdmin, PromptOnSecureDesktop |
>>   Format-Table -AutoSize
>>

PSPath
------
Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Policie...


