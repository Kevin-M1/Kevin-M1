<#
.SYNOPSIS
    Remediates WN10-CC-000275 DISA STIG for Windows 10.

.DESCRIPTION
    Ensures local drive redirection is prevented in Remote Desktop Session Hosts 
    by setting the 'fDisableCdm' registry policy to 1. 

    This improves system security by blocking remote users from accessing local drives 
    on their client device during an RDP session, reducing the risk of data leakage 
    or unauthorized file transfers.
#>
.NOTES
    Author          : Kevin Mejia
    LinkedIn        :https://www.linkedin.com/in/kevin-mejia-901039270/
    GitHub          : https://github.com/Kevin-M1
    Date Created    : 2025-08-31
    Last Modified   : 2025-08-31
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-CC-000275

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    
    Example syntax:
    PS C:\> .\__(WN10-CC-000275).ps1 

PS C:\Users\Kevin0715> # Create the policy path if it doesn't exist
>> $regPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services"
>> if (-not (Test-Path $regPath)) {
>>     New-Item -Path $regPath -Force | Out-Null
>> }
>>
>> # Set the policy value: 1 = Enabled (Drive redirection disabled)
>> Set-ItemProperty -Path $regPath -Name "fDisableCdm" -Type DWord -Value 1
>>
>> # Optional: Force Group Policy to refresh
>> gpupdate /force
>>
>> Write-Output "? Local drive redirection via RDP has been disabled."
>>
Updating policy...

Computer Policy update has completed successfully.
User Policy update has completed successfully.

Write-Output "âœ… Local drive redirection via RDP has been disabled."
